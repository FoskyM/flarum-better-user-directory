(()=>{var t={n:r=>{var s=r&&r.__esModule?()=>r.default:()=>r;return t.d(s,{a:s}),s},d:(r,s)=>{for(var o in s)t.o(s,o)&&!t.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:s[o]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r)};(()=>{"use strict";const r=flarum.core.compat["common/app"];var s=t.n(r);s().initializers.add("foskym/flarum-better-user-directory",(function(){console.log("[foskym/flarum-better-user-directory] Hello, forum and admin!")}));const o=flarum.core.compat["forum/app"];var e=t.n(o);const a=flarum.core.compat["common/extend"],n=flarum.core.compat["common/components/Button"];var c=t.n(n);const i=flarum.core.compat["common/components/LoadingIndicator"];var u=t.n(i);const l=flarum.core.compat["common/components/Placeholder"];var d=t.n(l);function f(t,r){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},f(t,r)}function p(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,f(t,r)}const y=flarum.core.compat["common/Component"];var v=t.n(y);const _=flarum.core.compat["forum/components/UserCard"];var h=t.n(_);const b=flarum.core.compat["common/utils/ItemList"];var N=t.n(b);const g=flarum.core.compat["common/helpers/icon"];var C=t.n(g),U={joined:["","username_az","username_za","newest","oldest","nickname_az","nickname_za","most_groups_count"],"custom-levels":["most_exp","least_exp"],"discussion-count":["most_discussions","least_discussions"],"best-answer-count":["most_best_answers","least_best_answers"],"monthly-comment-count":["most_monthly_comments","least_monthly_comments"],"monthly-discussion-count":["most_monthly_discussions","least_monthly_discussions"],lastSeen:["recently_seen","least_recently_seen","recently_checkin","most_total_checkin","most_total_continuous_checkin"],"comment-count":["most_comments","least_comments"],money:["most_money","least_money"],likesReceived:["most_likes_received","least_likes_received"],badges:["most_badges_count","least_badges_count"]},k=function(t){function r(){return t.apply(this,arguments)||this}return p(r,t),r.prototype.infoItems=function(){var r=new(N()),o=this.attrs.user,e=this.attrs.params.sort||"",a=t.prototype.infoItems.call(this);if(a.add("discussion-count",m("div",{className:"userStat"},C()("fas fa-comment"),s().translator.trans("fof-user-directory.forum.page.usercard.discussion-count",{count:o.discussionCount()})),70),a.add("comment-count",m("div",{className:"userStat"},C()("fas fa-comments"),s().translator.trans("fof-user-directory.forum.page.usercard.post-count",{count:o.commentCount()})),69),s().forum.attribute("foskym-better-user-directory.show_all_items_in_top_cards"))return a;for(var n in U)U[n].includes(e)&&a.has(n)&&r.add(n,a.get(n));return r},r}(h()),w=function(t){function r(){return t.apply(this,arguments)||this}return p(r,t),r.prototype.view=function(){var t=this.attrs.user,r=this.attrs.position,s=this.attrs.params,o="",e=r;return 1===r?(o="second",e=2):2===r?(o="first",e=1):3===r&&(o="third"),m("div",null,m("div",{className:"PodiumUser-card"},k.component({user:t,className:"UserCard--directory UserCard--podium",controlsButtonClassName:"Button Button--icon Button--flat",position:r,params:s})),m("span",{className:"PodiumUser-position "+o},e))},r}(v());const L=flarum.core.compat["forum/utils/UserControls"];var D=t.n(L);const P=flarum.core.compat["common/helpers/avatar"];var x=t.n(P);const B=flarum.core.compat["common/helpers/username"];var S=t.n(B);const I=flarum.core.compat["common/components/Dropdown"];var O=t.n(I);const j=flarum.core.compat["common/components/Link"];var z=t.n(j);const A=flarum.core.compat["forum/components/AvatarEditor"];var R=t.n(A);const M=flarum.core.compat["common/helpers/listItems"];var E=t.n(M);const G=flarum.core.compat["common/utils/classList"];var H=t.n(G),T=function(t){function r(){return t.apply(this,arguments)||this}p(r,t);var o=r.prototype;return o.view=function(){var r=t.prototype.view.bind(this)(),o=this.attrs.user,e=D().controls(o,this).toArray(),a=o.color(),n=o.badges().toArray(),c=this.attrs.position;return r.attrs.className=H()("UserCard UserCard--order",this.attrs.className,r.attrs.className),a&&(r.attrs.style["--usercard-bg"]=a),r.children[0]=m("div",{className:"darkenBackground"},m("div",{className:"container"},!!e.length&&m(O(),{className:"UserCard-controls App-primaryControl",menuClassName:"Dropdown-menu--right",buttonClassName:this.attrs.controlsButtonClassName,label:s().translator.trans("core.forum.user_controls.button"),accessibleToggleLabel:s().translator.trans("core.forum.user_controls.toggle_dropdown_accessible_label"),icon:"fas fa-ellipsis-v"},e),m("div",{className:"UserCard--order-position"},c),m("div",{className:"UserCard-profile"},m("h1",{className:"UserCard-identity"},this.attrs.editable?m("[",null,m(R(),{user:o,className:"UserCard-avatar"})," ",S()(o)):m(z(),{href:s().route.user(o)},m("div",{className:"UserCard-avatar"},x()(o,{loading:"eager"})),S()(o))),!!n.length&&m("ul",{className:"UserCard-badges badges"},E()(n)),m("ul",{className:"UserCard-info"},E()(this.infoItems().toArray()))))),r},o.infoItems=function(){var r=new(N()),o=this.attrs.user,e=this.attrs.params.sort||"",a=t.prototype.infoItems.call(this);if(a.add("discussion-count",m("div",{className:"userStat"},C()("fas fa-comment"),s().translator.trans("fof-user-directory.forum.page.usercard.discussion-count",{count:o.discussionCount()})),70),a.add("comment-count",m("div",{className:"userStat"},C()("fas fa-comments"),s().translator.trans("fof-user-directory.forum.page.usercard.post-count",{count:o.commentCount()})),69),s().forum.attribute("foskym-better-user-directory.show_all_items_in_bottom_cards"))return a;for(var n in U)U[n].includes(e)&&a.has(n)&&r.add(n,a.get(n));return a},r}(h());e().initializers.add("foskym/flarum-better-user-directory",(function(){if("fof-user-directory"in flarum.extensions){var t,r,s,o,n=null==(t=flarum.extensions["fof-user-directory"])?void 0:t.UserDirectoryPage;(0,a.extend)(n.prototype,"viewItems",(function(t){e().forum.attribute("foskym-better-user-directory.hide_search")&&t.remove("search"),e().forum.attribute("foskym-better-user-directory.hide_filter_groups")&&t.remove("filterGroups")}));var i=null==(r=flarum.extensions["fof-user-directory"])?void 0:r.components,l=null==i?void 0:i.UserDirectoryUserCard,f=null==i?void 0:i.SmallUserCard,p=null==(s=flarum.extensions["fof-user-directory"])?void 0:s.UserDirectoryListItem;(0,a.override)(p.prototype,"view",(function(t){var r=this.attrs,s=r.user,o=r.useSmallCards,a=r.isPodium,n={user:s,className:"UserCard--directory"+(o?" UserCard--small":""),controlsButtonClassName:"Button Button--icon Button--flat",position:r.position,params:r.params};return e().forum.attribute("foskym-better-user-directory.podium_style")?a?m("div",{className:"User"},w.component(n)):m("div",{className:"User"},T.component(n)):m("div",{className:"User"},o?f.component(n):l.component(n))}));var y=null==(o=flarum.extensions["fof-user-directory"])?void 0:o.UserDirectoryList;(0,a.override)(y.prototype,"view",(function(t){var r,s=this.attrs.state,o=s.getParams(),a=e().forum.attribute("userDirectorySmallCards");if(s.isLoading()?r=u().component():s.moreResults&&(r=c().component({className:"Button",onclick:s.loadMore.bind(s)},e().translator.trans("fof-user-directory.forum.page.load_more_button"))),s.empty()){var n=e().translator.trans("fof-user-directory.forum.page.empty_text");return m("div",{className:"DiscussionList"},d().component({text:n}))}var i=e().forum.attribute("foskym-better-user-directory.podium_style"),l=s.users.slice(0,3),f=i?s.users.slice(3):s.users;if(l.length>=2){var y=[l[1],l[0]];l[0]=y[0],l[1]=y[1]}return m("div",{className:"UserDirectoryList"+(s.isSearchResults()?" UserDirectoryList--searchResults":"")+(a?" UserDirectoryList--small-cards":"")},i&&m("ul",{className:"UserDirectoryList-Podium-users"},l.map((function(t,r){return m("li",{key:t.id(),"data-id":t.id()},p.component({user:t,params:o,useSmallCards:a,isPodium:!0,position:r+1}))}))),m("ul",{className:"UserDirectoryList-users"},f.map((function(t,r){return m("li",{key:t.id(),"data-id":t.id()},p.component({user:t,params:o,useSmallCards:a,isPodium:!1,position:r+4}))}))),m("div",{className:"UserDirectoryList-loadMore"},r))}))}}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map